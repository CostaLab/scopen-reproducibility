setwd("/run/user/1001/gvfs/sftp:host=login.hpc.itc.rwth-aachen.de,user=rs619065/rwthfs/rz/cluster/home/rs619065/SingleCellOpenChromatin/Conformation/GM12878_Impute")
library(ggplot2)
library(cicero)
df <- read.table("GM12878.txt", header = TRUE)
input_cds <- make_atac_cds(df, binarize = FALSE)
set.seed(2018)
input_cds <- detectGenes(input_cds)
input_cds <- estimateSizeFactors(input_cds)
input_cds <- reduceDimension(input_cds, max_components = 2, num_dim=6,
reduction_method = 'tSNE', norm_method = "none")
head(df)
df <- read.table("GM12878_imputed.txt", header = TRUE)
input_cds <- make_atac_cds(df, binarize = FALSE)
set.seed(2018)
input_cds <- detectGenes(input_cds)
input_cds <- estimateSizeFactors(input_cds)
input_cds <- reduceDimension(input_cds, max_components = 2, num_dim=6,
reduction_method = 'tSNE', norm_method = "none")
tsne_coords <- t(reducedDimA(input_cds))
row.names(tsne_coords) <- row.names(pData(input_cds))
cicero_cds <- make_cicero_cds(input_cds, reduced_coordinates = tsne_coords)
data("human.hg19.genome")
conns <- run_cicero(cicero_cds, human.hg19.genome) # Takes a few minutes to run
write.table(conns, file = "./GM12878.txt", sep = "\t", quote = FALSE,
row.names = FALSE)
gene_annotation <- read.table("gencode.v19.txt", header = TRUE)
gene_annotation$strand <- as.character(gene_annotation$strand)
gene_annotation$feature <- as.character(gene_annotation$feature)
gene_annotation$gene <- as.character(gene_annotation$gene)
gene_annotation$transcript <- as.character(gene_annotation$transcript)
gene_annotation$symbol <- as.character(gene_annotation$symbol)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "gene",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
?reduceDimension
set.seed(2018)
input_cds <- detectGenes(input_cds)
input_cds <- estimateSizeFactors(input_cds)
input_cds <- reduceDimension(input_cds, max_components = 2, num_dim=50,
reduction_method = 'tSNE', norm_method = "none")
?reduceDimension
??reduceDimension
setwd("/run/user/1001/gvfs/sftp:host=login.hpc.itc.rwth-aachen.de,user=rs619065/rwthfs/rz/cluster/home/rs619065/SingleCellOpenChromatin/Conformation/GM12878_Impute")
library(ggplot2)
library(cicero)
df <- read.table("GM12878_imputed.txt", header = TRUE)
input_cds <- make_atac_cds(df, binarize = FALSE)
set.seed(2018)
input_cds <- detectGenes(input_cds)
input_cds <- estimateSizeFactors(input_cds)
input_cds <- reduceDimension(input_cds, max_components = 2, num_dim=6,
reduction_method = 'tSNE', norm_method = "none",
check_duplicates = FALSE)
tsne_coords <- t(reducedDimA(input_cds))
row.names(tsne_coords) <- row.names(pData(input_cds))
cicero_cds <- make_cicero_cds(input_cds, reduced_coordinates = tsne_coords)
data("human.hg19.genome")
conns <- run_cicero(cicero_cds, human.hg19.genome) # Takes a few minutes to run
write.table(conns, file = "./GM12878_Cicero.txt", sep = "\t", quote = FALSE,
row.names = FALSE)
gene_annotation <- read.table("gencode.v19.txt", header = TRUE)
gene_annotation$strand <- as.character(gene_annotation$strand)
gene_annotation$feature <- as.character(gene_annotation$feature)
gene_annotation$gene <- as.character(gene_annotation$gene)
gene_annotation$transcript <- as.character(gene_annotation$transcript)
gene_annotation$symbol <- as.character(gene_annotation$symbol)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "gene",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
conns <- read.table("GM12878_Cicero.txt")
gene_annotation <- read.table("hg19.annotation.bed", header = TRUE)
head(gene_annotation)
gene_annotation <- read.table("hg19.annotation.bed", header = TRUE, sep = "\t")
head(gene_annotation)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "gene",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
library(ggplot2)
library(cicero)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "gene",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
head(conns)
conns <- read.table("GM12878_Cicero.txt", header = TRUE)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "gene",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
head(gene_annotation)
gene_annotation$strand <- as.character(gene_annotation$strand)
gene_annotation$feature <- as.character(gene_annotation$feature)
gene_annotation$gene <- as.character(gene_annotation$gene)
gene_annotation$transcript <- as.character(gene_annotation$transcript)
gene_annotation$symbol <- as.character(gene_annotation$symbol)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "gene",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
head(gene_annotation)
gene_annotation <- read.table("hg19.annotation.bed", header = TRUE, sep = "\t")
gene_annotation$strand <- as.character(gene_annotation$strand)
gene_annotation$feature <- as.character(gene_annotation$feature)
gene_annotation$gene <- as.character(gene_annotation$gene)
gene_annotation$transcript <- as.character(gene_annotation$transcript)
gene_annotation$symbol <- as.character(gene_annotation$symbol)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "gene",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
head(gene_annotation)
?plot_connections
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "symbol",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
?plot_connections
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "shortest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
sample_genome <- subset(human.hg19.genome, V1 == "chr18")
data("human.hg19.genome")
sample_genome <- subset(human.hg19.genome, V1 == "chr18")
data(gene_annotation_sample)
gene_annotation_sample
head(gene_annotation_sample)
gene_annotation_18 <- subset(gene_annotation, chromosome == "chr18")
head(gene_annotation_18)
gene_annotation_sample$strand
unique(gene_annotation_sample$strand)
tail(gene_annotation_sample$strand)
head(gene_annotation_sample, n = 20)
head(gene_annotation_18, n = 20)
write.table(gene_annotation_sample, file = "example.bed", quote = FALSE, sep = "\t")
unique(gene_annotation_sample$feature)
unique(gene_annotation_18$feature)
gene_annotation_18 <- subseq(gene_annotation_18, feature %in% unique(gene_annotation_sample$feature))
gene_annotation_18 <- subset(gene_annotation_18, feature %in% unique(gene_annotation_sample$feature))
unique(gene_annotation_18$feature)
data(gene_annotation_sample)
gene_annotation <- subset(gene_annotation, feature %in% unique(gene_annotation_sample$feature))
gene_annotation$strand <- as.character(gene_annotation$strand)
gene_annotation$feature <- as.character(gene_annotation$feature)
gene_annotation$gene <- as.character(gene_annotation$gene)
gene_annotation$transcript <- as.character(gene_annotation$transcript)
gene_annotation$symbol <- as.character(gene_annotation$symbol)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "shortest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
conns <- read.table("GM12878_Cicero.txt", header = TRUE)
gene_annotation <- read.table("hg19.annotation.bed", header = TRUE, sep = "\t")
data(gene_annotation_sample)
gene_annotation <- subset(gene_annotation, feature %in% unique(gene_annotation_sample$feature))
gene_annotation$strand <- as.character(gene_annotation$strand)
gene_annotation$feature <- as.character(gene_annotation$feature)
gene_annotation$gene <- as.character(gene_annotation$gene)
gene_annotation$transcript <- as.character(gene_annotation$transcript)
gene_annotation$symbol <- as.character(gene_annotation$symbol)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
library(ggplot2)
library(cicero)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
gene_annotation <- read.table("hg19.annotation.bed", header = TRUE, sep = "\t")
gene_annotation <- read.table("hg19.annotation.bed", header = TRUE, sep = "\t")
gene_annotation <- subset(gene_annotation, feature %in% unique(gene_annotation_sample$feature))
gene_annotation$strand <- as.character(gene_annotation$strand)
gene_annotation$feature <- as.character(gene_annotation$feature)
gene_annotation$gene <- as.character(gene_annotation$gene)
gene_annotation$transcript <- as.character(gene_annotation$transcript)
gene_annotation$symbol <- as.character(gene_annotation$symbol)
data(gene_annotation_sample)
gene_annotation <- subset(gene_annotation, feature %in% unique(gene_annotation_sample$feature))
gene_annotation$strand <- as.character(gene_annotation$strand)
gene_annotation$feature <- as.character(gene_annotation$feature)
gene_annotation$gene <- as.character(gene_annotation$gene)
gene_annotation$transcript <- as.character(gene_annotation$transcript)
gene_annotation$symbol <- as.character(gene_annotation$symbol)
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "gene",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
?plot_connections
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42571957,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "shortest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348190, 42561900,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348000, 42562000,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
dev.off()
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42348000, 42562000,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = .5,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
viewpoint_color = "#a6cee3",
viewpoint_fill = "#a6cee3",
viewpoint_alpha = 0.3,
include_axis_track = FALSE)
dev.off()
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42340000, 42562000,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = 1.0,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
viewpoint_color = "#a6cee3",
viewpoint_fill = "#a6cee3",
viewpoint_alpha = 0.3,
include_axis_track = FALSE)
dev.off()
pdf("GM12878.pdf", height = 4, width = 6)
plot_connections(conns, "chr19", 42340000, 42562000,
gene_model = gene_annotation,
coaccess_cutoff = 0.0,
connection_width = 1.0,
collapseTranscripts = "longest",
viewpoint = "chr19_42379190_42380000",
include_axis_track = FALSE)
